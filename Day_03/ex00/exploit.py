from bs4 import BeautifulSoup


def hack_html():
    """
    Modifies the 'evilcorp.html' file and saved as 'evilcorp_hacked.html'.

    Returns:
        None
    """
    with open("evilcorp.html") as fp:
        soup = BeautifulSoup(fp, features="html.parser")

    # Changing the page title
    soup.title.string = "Evil Corp - Stealing your money every day"

    # Parsing name
    name_span = soup.find('span', class_='name')
    name = name_span.get_text(strip=True)

    # Adding new tag <h1>'name', you are hacked!</h1>
    new_tag = soup.new_tag('h1')
    new_tag.string = f"{name}, you are hacked!"
    soup.body.insert(0, new_tag)

    # Adding a script
    new_tag = soup.new_tag('script')
    new_tag.string = """
        hacked = function() {
            alert('hacked');
        }
        window.addEventListener('load', 
          function() { 
            var f = document.querySelector("form");
            f.setAttribute("onsubmit", "hacked()");
          },
          false
        );
    """
    soup.body.append(new_tag)

    # Changing info about the company
    a_tag = soup.a
    new_tag = soup.new_tag("a", href="https://mrrobot.fandom.com/wiki/Fsociety")
    new_tag.string = "Fsociety"
    a_tag.replace_with(new_tag)

    # Saving new HTML file
    with open('evilcorp_hacked.html', 'w', encoding='utf-8') as file:
        file.write(str(soup))


if __name__ == '__main__':
    hack_html()
